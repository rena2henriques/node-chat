if (self.CavalryLogger) { CavalryLogger.start_js(["RTqtt"]); }

__d('PagesComposerUnpublishedPostsStore',['ReactComposerStoreBase','PagesComposerActionsTypes'],(function a(b,c,d,e,f,g){var h,i,j={isDraft:false,scheduledPublishTime:null,backdateConfig:null,isAdsPost:false,stopFeedDistributionDate:null,isOfferUpsellShown:false,isOfferUpsellAbandoned:false,offerConfig:null};h=babelHelpers.inherits(k,c('ReactComposerStoreBase'));i=h&&h.prototype;function k(){'use strict';var l;i.constructor.call(this,function(){return Object.assign({},j);},function(m){switch(m.type){case c('PagesComposerActionsTypes').BACKDATE:l&&l.$PagesComposerUnpublishedPostsStore1(m);break;case c('PagesComposerActionsTypes').SET_DRAFT:l&&l.$PagesComposerUnpublishedPostsStore2(m);break;case c('PagesComposerActionsTypes').SCHEDULE:l&&l.$PagesComposerUnpublishedPostsStore3(m);break;case c('PagesComposerActionsTypes').SET_ADS_POST:l&&l.$PagesComposerUnpublishedPostsStore4(m);break;case c('PagesComposerActionsTypes').SHOW_OFFER_UPSELL:l&&l.$PagesComposerUnpublishedPostsStore5(m);break;case c('PagesComposerActionsTypes').ABANDON_OFFER_UPSELL:l&&l.$PagesComposerUnpublishedPostsStore6(m);break;}});l=this;}k.prototype.getBackdateConfig=function(l){'use strict';return this.getComposerData(l).backdateConfig;};k.prototype.getIsDraft=function(l){'use strict';return this.getComposerData(l).isDraft;};k.prototype.getScheduledPublishTime=function(l){'use strict';return this.getComposerData(l).scheduledPublishTime;};k.prototype.getStopFeedDistributionTime=function(l){'use strict';return this.getComposerData(l).stopFeedDistributionDate;};k.prototype.getIsAdsPost=function(l){'use strict';return this.getComposerData(l).isAdsPost;};k.prototype.getIsOfferUpsellShown=function(l){'use strict';return this.getComposerData(l).isOfferUpsellShown;};k.prototype.getIsOfferUpsellAbandoned=function(l){'use strict';return this.getComposerData(l).isOfferUpsellAbandoned;};k.prototype.getOfferConfig=function(l){'use strict';return this.getComposerData(l).offerConfig;};k.prototype.$PagesComposerUnpublishedPostsStore1=function(l){'use strict';var m=this.getComposerData(l.composerID);m.backdateConfig={year:l.year,month:l.month,day:l.day,hideFromNewsFeed:l.hideFromNewsFeed};};k.prototype.$PagesComposerUnpublishedPostsStore3=function(l){'use strict';var m=this.getComposerData(l.composerID);m.scheduledPublishTime=l.scheduleDate;m.stopFeedDistributionDate=l.stopFeedDistributionDate;};k.prototype.$PagesComposerUnpublishedPostsStore2=function(l){'use strict';var m=this.getComposerData(l.composerID);m.isDraft=true;};k.prototype.$PagesComposerUnpublishedPostsStore4=function(l){'use strict';var m=this.getComposerData(l.composerID);m.isAdsPost=true;};k.prototype.$PagesComposerUnpublishedPostsStore5=function(l){'use strict';var m=this.validateAction(l,['composerID','config']),n=m[0],o=m[1],p=this.getComposerData(n);p.offerConfig=o;p.isOfferUpsellShown=true;this.emitChange(n);};k.prototype.$PagesComposerUnpublishedPostsStore6=function(l){'use strict';var m=this.getComposerData(l.composerID);m.isOfferUpsellAbandoned=true;};f.exports=new k();}),null);
__d('ReactComposerFocusStore',['ReactComposerFocusActionTypes','ReactComposerStoreBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ReactComposerStoreBase'));i=h&&h.prototype;function j(){var k=void 0;i.constructor.call(this,function(){return {focusConfig:{},isFocused:false};},function(l){if(!k)return;switch(l.type){case c('ReactComposerFocusActionTypes').SUBSCRIBE:k.$ReactComposerFocusStore1(l.composerID,l.onFocusAcquiredCallback,l.onFocusLostCallback);k.emitChange(l.composerID);break;case c('ReactComposerFocusActionTypes').UNSUBSCRIBE:k.$ReactComposerFocusStore2(l.composerID);k.emitChange(l.composerID);break;case c('ReactComposerFocusActionTypes').FOCUS_ACQUIRED:k.$ReactComposerFocusStore3(l.composerID);k.emitChange(l.composerID);break;case c('ReactComposerFocusActionTypes').FOCUS_LOST:k.$ReactComposerFocusStore4(l.composerID);k.emitChange(l.composerID);break;}});k=this;}j.prototype.$ReactComposerFocusStore1=function(k,l,m){var n=this.getComposerData(k);n.focusConfig={onFocusAcquiredCallback:l,onFocusLostCallback:m};};j.prototype.$ReactComposerFocusStore2=function(k){var l=this.getComposerData(k);l.focusConfig={};};j.prototype.$ReactComposerFocusStore3=function(k){var l=this.getComposerData(k);if(l.focusConfig.onFocusAcquiredCallback)setTimeout(l.focusConfig.onFocusAcquiredCallback,0);l.isFocused=true;};j.prototype.$ReactComposerFocusStore4=function(k){var l=this.getComposerData(k);if(l.focusConfig.onFocusLostCallback)setTimeout(l.focusConfig.onFocusLostCallback,0);l.isFocused=false;};j.prototype.isComposerFocused=function(k){return this.getComposerData(k).isFocused;};f.exports=new j();}),null);
__d("XAfterPartyWWWController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ads\/afterparty\/www\/",{page_id:{type:"Int",required:true},scrolling_offset:{type:"Int",defaultValue:0}});}),null);
__d("XUnpublishedPostSuccessController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/unpublished_posts\/post_success\/",{type:{type:"String",required:true}});}),null);
__d('PagesComposer',['csx','cx','ActorURI','Arbiter','AsyncRequest','Bootloader','ReactComposerFocusStore','ComposerXMarauderLogger','ComposerXStore','DOM','PagesComposerUnpublishedPostsStore','Parent','ReloadPage','Run','XUnpublishedPostSuccessController','XAfterPartyWWWController','$','getObjectValues','goURI'],(function a(b,c,d,e,f,g,h,i){var j=500,k=20,l=58,m=void 0,n=void 0;function o(){c('ComposerXMarauderLogger').logCompleted(m.id);}function p(s){if(s.hidePost){var t=c('ComposerXStore').getAllForComposer(m.id);if(!c('getObjectValues')(t).length){var u=null;if(c('PagesComposerUnpublishedPostsStore').getIsDraft(m.id))u='draft';if(c('PagesComposerUnpublishedPostsStore').getScheduledPublishTime(m.id))u='scheduled';if(u){var v=c('XUnpublishedPostSuccessController').getURIBuilder().setString('type',u).getURI();v=c('ActorURI').create(v,n);new (c('AsyncRequest'))().setURI(v).send();}}o();return;}if(s.redirect){var t=c('ComposerXStore').getAllForComposer(m.id);c('getObjectValues')(t).forEach(function(y){if(y.reset)y.reset(y);});c('goURI')(s.redirect);o();return;}if(!s.streamStory){c('ReloadPage').now();return;}if(s.backdatedTime){c('Bootloader').loadModules(["PagesStoryPublisher"],function(y){y.publish(s);},'PagesComposer');o();return;}var w=r.renderStory(m,s.streamStory);c('Arbiter').inform('TimelineComposer/on_after_publish',w,c('Arbiter').BEHAVIOR_PERSISTENT);if(n){var x=c('XAfterPartyWWWController').getURIBuilder().setInt('page_id',n);q(x,0);}o();}function q(s,t){if(!c('ReactComposerFocusStore').isComposerFocused(m.id)){if(t>0)s.setInt('scrolling_offset',l);new (c('AsyncRequest'))().setURI(s.getURI()).send();}else if(t<k)setTimeout(q.bind(this,s,t+1),j);}var r={init:function s(t,u){m=c('$')(t);n=u;var v=c('Arbiter').subscribe('composer/publish',function(event,w){if(w.composer_id===m.id)p(w);});c('Run').onLeave(v.unsubscribe.bind(v));},renderStory:function s(t,u){var v=c('Parent').bySelector(t,"#pagelet_timeline_main_column");if(!v)return;var w=c('DOM').scry(v,"._5sem")[0],x=c('DOM').prependContent(w,u)[0];c('Bootloader').loadModules(["Animation"],function(y){new y(x).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(y.ease.both).go();},'PagesComposer');return x;},replaceByID:function s(t,u){c('DOM').replace(c('$')(t),u);}};f.exports=b.PagesComposer||r;}),null);
__d('CanvasVideoThumbnail',['Promise','DOM','EventListener','VideoThumbnail','canvasToBlob'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('VideoThumbnail'));i=h&&h.prototype;function j(k,l,m){'use strict';i.constructor.call(this,null);this.$CanvasVideoThumbnail1=k;this.$CanvasVideoThumbnail2=l;this.$CanvasVideoThumbnail3=m;}j.prototype.getTime=function(){'use strict';return this.$CanvasVideoThumbnail3?this.$CanvasVideoThumbnail3:0;};j.prototype.getURL=function(){'use strict';if(!this.$CanvasVideoThumbnail4)this.$CanvasVideoThumbnail4=this.$CanvasVideoThumbnail1.toDataURL('image/jpeg');return this.$CanvasVideoThumbnail4;};j.prototype.getData=function(){'use strict';var k=c('DOM').create('canvas'),l=k.getContext('2d'),m=this.$CanvasVideoThumbnail2;return new (c('Promise'))(function(n,o){var p=c('EventListener').listen(m,'seeked',function(){p.remove();k.width=m.videoWidth;k.height=m.videoHeight;l.drawImage(m,0,0,k.width,k.height);c('canvasToBlob')(k,'image/jpeg').then(n,o);});m.currentTime=this.$CanvasVideoThumbnail3;}.bind(this));};j.prototype.getDataWithText=function(k,l,m,n,o,p,q,r){'use strict';var s=c('DOM').create('canvas'),t=s.getContext('2d'),u=this.$CanvasVideoThumbnail2;return new (c('Promise'))(function(v,w){var x=c('EventListener').listen(u,'seeked',function(){x.remove();s.width=u.videoWidth;s.height=u.videoHeight;t.fillStyle=q;t.textAlign=r;t.drawImage(u,0,0,s.width,s.height);t=c('VideoThumbnail').addTextToCanvasContext(t,k,l,m,n,o,p,q,r);c('canvasToBlob')(s,'image/jpeg').then(v,w).done();});u.currentTime=this.$CanvasVideoThumbnail3;}.bind(this));};f.exports=j;}),null);
__d('generateVideoThumbnails',['Promise','CanvasVideoThumbnail','EventListener','VideoFrameBuffer','VideoThumbnail'],(function a(b,c,d,e,f,g){function h(i,j,k,l){var m=arguments.length<=4||arguments[4]===undefined?'contain':arguments[4],n=arguments.length<=5||arguments[5]===undefined?0:arguments[5];return new (c('Promise'))(function(o,p){var q=document.createElement('canvas'),r=[],s=0,t=(i.duration-n)/l,u=new (c('VideoThumbnail'))(''),v=new (c('VideoFrameBuffer'))(q,i,m),w;q.width=j;q.height=k;var x=function z(){v.updateFrameBuffer();var aa=new (c('CanvasVideoThumbnail'))(q,i,n+(s-1)*t);r.push(aa);if(aa.getURL().length>u.getURL().length)u=aa;y();},y=function z(){if(s===0)w=c('EventListener').listen(i,'seeked',x);if(s<l){i.currentTime=n+s*t;s++;}else{if(w)w.remove();o({thumbnails:r,selectedThumbnail:u});}};if(i.videoWidth===0||i.videoHeight===0){p();return;}y();});}f.exports=h;}),null);