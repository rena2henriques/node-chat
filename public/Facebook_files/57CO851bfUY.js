if (self.CavalryLogger) { CavalryLogger.start_js(["wTi4B"]); }

__d('ChatTabViewEvents',['Arbiter'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('Arbiter'))();}),null);
__d("XPagesPresenceController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/presence\/",{});}),null);
__d('PagePresencePoller',['ActorURI','AsyncRequest','UserActivity','XPagesPresenceController'],(function a(b,c,d,e,f,g){'use strict';var h=90000,i=0,j=function l(m){i=Date.now();var n=c('XPagesPresenceController').getURIBuilder().getURI(),o=c('ActorURI').create(n,m);new (c('AsyncRequest'))().setURI(o).send();},k={init:function l(m){c('UserActivity').subscribe(function(){if(Date.now()-i>h)j(m);});setInterval(function(){if(c('UserActivity').isActive())j(m);},h);}};f.exports=k;}),null);
__d('PageTimelineChainingTypeConstants',[],(function a(b,c,d,e,f,g){f.exports={FANNING:'fanning',FOLLOW:'follow'};}),null);
__d('PagesTimelineChaining',['Arbiter','CSS','Event','ChatTabViewEvents','PagesFollowStore','PageLikeConstants','PageTimelineChainingTypeConstants','Run','Style','SubscriptionsHandler','UIPagelet'],(function a(b,c,d,e,f,g){var h=0,i={_recentlyLikedPageIDs:{},_recentlyMessagedPageIDs:{},container:null,_subscriptions:[],_chatSubscriptions:[],_followSubscription:null,_isFollow:false,_shouldShowRelatedPagesOnBounce:false,init:function j(k,l){this.container=k;this._followSubscription=new (c('SubscriptionsHandler'))();this._isFollow=l.isFollow;this._shouldShowRelatedPagesOnBounce=l.shouldShowRelatedPagesOnBounce;c('Run').onLeave(function(){return this._unsubscribe();}.bind(this));if(!this._showChainSuggestions(l.pageID,false)){this._subscriptions=[c('Arbiter').subscribe(c('PageLikeConstants').LIKED,this.onLike.bind(this,l.pageID))];if(l.canFollow)this._followSubscription.addSubscriptions(c('PagesFollowStore').addListener(function(){var m=c('PagesFollowStore').getState();if(!(l.pageID in m))return;if(m[l.pageID]&&!this._isFollow)this._onFollow(l.pageID);this._isFollow=m[l.pageID];}.bind(this)));if(l.enableLikeCheckup)this._subscriptions.push(c('Arbiter').subscribe(c('PageLikeConstants').UNLIKED,this.onUnlike.bind(this)));if(l.onMessageEnabled)this._chatSubscriptions.push(c('ChatTabViewEvents').subscribe('chat-send-to-page',this.onMessage.bind(this,l.pageID)));if(l.shouldShowRelatedPagesOnBounce)window.addEventListener('scroll',this.onScroll.bind(this,l.pageID),false);}},onScroll:function j(k){if(document.documentElement){var l=window.pageYOffset||document.documentElement.scrollTop;if(l<=h){this._showChainSuggestions(k,true);this._unsubscribe();}h=l;}},onLike:function j(k,l,m){if(m.profile_id===k&&m.target){this._recentlyLikedPageIDs[k]=true;this._showChainSuggestions(k,false);this._unsubscribe();}},_onFollow:function j(k){this._showChainFollowSuggestions(k);this._unsubscribe();},onMessage:function j(k,l,m){if(m&&m.pageID===k){this._recentlyMessagedPageIDs[k]=true;this._showMessageSuggestions(k);this._unsubscribe();}},onUnlike:function j(k,l){c('UIPagelet').loadFromEndpoint('PagesLikeCheckupPagelet',this.container,{},{displayCallback:this.displayCallback.bind(this)});this._unsubscribe();},displayCallback:function j(k){if(k)k();var l=this.container.firstChild;if(l)c('Style').set(this.container,'height',l.offsetHeight+'px');},_showChainSuggestions:function j(k,l){if(!(k in this._recentlyLikedPageIDs)&&!(this._shouldShowRelatedPagesOnBounce&&l))return false;var m=c('PageTimelineChainingTypeConstants').FANNING;c('UIPagelet').loadFromEndpoint('PagesTimelineChainingPagelet',this.container,{pageID:k,type:m},{displayCallback:this.displayCallback.bind(this)});return true;},_showChainFollowSuggestions:function j(k){var l=c('PageTimelineChainingTypeConstants').FOLLOW;c('UIPagelet').loadFromEndpoint('PagesTimelineChainingPagelet',this.container,{pageID:k,type:l},{displayCallback:this.displayCallback.bind(this)});return true;},_showMessageSuggestions:function j(k){if(!(k in this._recentlyMessagedPageIDs))return false;c('UIPagelet').loadFromEndpoint('PagesMessageChainingPagelet',this.container,{pageID:k},{displayCallback:this.displayCallback.bind(this)});return true;},dismissCallback:function j(k,l){c('CSS').hide(this.container);delete this._recentlyLikedPageIDs[l];this._unsubscribe();},attachDismissCallback:function j(k,l,m){c('Event').listen(k,'click',this.dismissCallback.bind(this,l,m));},_unsubscribe:function j(){if(this._subscriptions.length){this._subscriptions.forEach(function(k){return c('Arbiter').unsubscribe(k);});this._subscriptions=[];}if(this._chatSubscriptions.length){this._chatSubscriptions.forEach(function(k){return c('ChatTabViewEvents').unsubscribe(k);});this._chatSubscriptions=[];}this._followSubscription&&this._followSubscription.release();}};f.exports=i;}),null);